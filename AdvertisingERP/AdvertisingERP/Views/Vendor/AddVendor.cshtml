@model AdvertisingERP.Models.Vendor
    @{
        ViewBag.Title = "AddVendor";
        Layout = "~/Views/Shared/_layout.cshtml";
    }
    <div class="clearfix"></div>

    <div class="content-wrapper">
        <div class="container-fluid">
            <div class="col-md-12">
                <div class="page-breadcrumb">
                    <div class="row">
                        <div class="col-5 align-self-center">
                            <h4 class="page-title"></h4>
                            <div class="d-flex align-items-center">
                                <nav aria-label="breadcrumb">
                                    <ol class="breadcrumb">
                                        <li class="breadcrumb-item"><a href="#">Vendor</a></li>
                                        <li class="breadcrumb-item active" aria-current="page">AddVendor</li>
                                    </ol>
                                </nav>
                            </div>
                        </div>

                    </div>
                </div>

                <div class="card">
                    <div class="card-body">
                        <div class="m-b-0 card-title">
                            Add New Vendor
                            <a href="/Vendor/VendorList" class="btn btn-light list-button" style="margin-left: 72%;">Back To List</a>
                        </div>
                        <hr>
                        @using (Html.BeginForm("AddVendor", "Vendor", FormMethod.Post, new { @id = "signupForm", enctype = "multipart/form-data" }))
                        {

         

                                <div class="alert alert-success" style="display:@ViewBag.errormsg">
                                    <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">×</span> </button>
                                    <h5 class="text-success"><i class="fa fa-check-circle"></i>@TempData["VendorError"]</h5>
                                </div>
                                <div class="row">
                                    <div class="col-lg-12">
                                        
                                            

                                            <div class="form-body">
                                              
                                                <div class="card-body">

                                                    <div class="row">
                                                        <div class="col-md-12">
                                                            <div class="form-group row">
                                                                <label class="control-label col-md-3">Vendor Name<span style="color: red">*</span></label>
                                                                <div class="col-md-12">
                                                                    @Html.TextBoxFor(m => m.VendorName, new { @class = "form-control form-control-lg", @Placeholder = "Vendor Name", @style = "text-transform:capitalize" })
                                                                    @Html.HiddenFor(m => m.VendorCode)
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>

                                                    <div class="row">
                                                        <div class="col-md-4">
                                                            <div class="form-group row">
                                                                <label class="control-label text-right col-md-3">Nature Of Business </label>
                                                                <div class="col-md-9">
                                                                    @Html.DropDownListFor(m => m.ServiceTypeName, new SelectList(ViewBag.ddlServiceType, "Value", "Text"), new { @class = "form-control", @onchange = "return ServiceTypeChange()" })
                                                                    @Html.HiddenFor(m => m.ServiceTypeID)
                                                                    <a onclick="return clearServices();" class="btn btn-light list-button">Clear All</a>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-md-4">
                                                            <div class="form-group row">
                                                                <label class="control-label text-right col-md-3">Mobile No <span style="color: red">*</span></label>
                                                                <div class="col-md-9">
                                                                    @Html.TextBoxFor(m => m.MobileNo, new { @class = "form-control form-control-lg", @Placeholder = "Mobile No", onkeypress = "return isNumber(event);", @maxlength = "10" })
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-md-4">
                                                            <div class="form-group row">
                                                                <label class="control-label text-right col-md-3">Email <span style="color: red">*</span></label>
                                                                <div class="col-md-9">
                                                                    @Html.TextBoxFor(m => m.Email, new { @class = "form-control form-control-lg", @Placeholder = "Email" })
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-md-12">
                                                            <div class="form-group row">
                                                                <input type="text" id="lblServiceDisplay" class="form-control" , readonly="readonly" />
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col-md-12">
                                                            <div class="form-group row">
                                                                <label class="control-label col-md-3">Address <span style="color: red">*</span></label>
                                                                <div class="col-md-12">
                                                                    @Html.TextBoxFor(m => m.Address, new { @class = "form-control form-control-lg", @Placeholder = "Address" })
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>

                                                    <div class="row">
                                                        <div class="col-md-4">
                                                            <div class="form-group row">
                                                                <label class="control-label text-right col-md-3">Pincode <span style="color: red">*</span></label>
                                                                <div class="col-md-9">
                                                                    @Html.TextBoxFor(m => m.Pincode, new { @class = "form-control form-control-lg", @Placeholder = "Pincode", @onchange = "getstatecity();", onkeypress = "return isNumber(event);", @maxlength = "6" })
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-md-4">
                                                            <div class="form-group row">
                                                                <label class="control-label text-right col-md-3">State  <span style="color: red">*</span></label>
                                                                <div class="col-md-9">
                                                                    @Html.TextBoxFor(m => m.StateName, new { @class = "form-control form-control-lg", @Placeholder = "State", @readonly = "true" })
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-md-4">
                                                            <div class="form-group row">
                                                                <label class="control-label text-right col-md-3">City <span style="color: red">*</span></label>
                                                                <div class="col-md-9">
                                                                    @Html.TextBoxFor(m => m.City, new { @class = "form-control form-control-lg", @Placeholder = "City", @readonly = "true" })
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>

                                                    <div class="row">
                                                        <div class="col-md-4">
                                                            <div class="form-group row">
                                                                <label class="control-label text-right col-md-3">Bank Name </label>
                                                                <div class="col-md-9">
                                                                    @Html.TextBoxFor(m => m.BankName, new { @class = "form-control form-control-lg", @Placeholder = "Bank Name", @style = "text-transform:capitalize" })
                                                                    @Html.HiddenFor(m => m.BankNameSplit)
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-md-4">
                                                            <div class="form-group row">
                                                                <label class="control-label text-right col-md-3">Account No </label>
                                                                <div class="col-md-9">
                                                                    @Html.TextBoxFor(m => m.AccountNo, new { @class = "form-control form-control-lg", @Placeholder = "Account No", onkeypress = "return isNumber(event);" })
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-md-4">
                                                            <div class="form-group row">
                                                                <label class="control-label text-right col-md-3">IFSC Code </label>
                                                                <div class="col-md-9">
                                                                    @Html.TextBoxFor(m => m.IFSCCode, new { @class = "form-control form-control-lg", @Placeholder = "IFSC Code", @style = "text-transform:uppercase" })
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>

                                                    <div class="row">
                                                        <div class="col-md-4">
                                                            <div class="form-group row">
                                                                <label class="control-label text-right col-md-3">Concern Person </label>
                                                                <div class="col-md-9">
                                                                    @Html.TextBoxFor(m => m.ConcernPerson, new { @class = "form-control form-control-lg", @Placeholder = "Concern Person", @style = "text-transform:capitalize" })
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-md-4">
                                                            <div class="form-group row">
                                                                <label class="control-label text-right col-md-3">Concern Person 1 Designation</label>
                                                                <div class="col-md-9">
                                                                    @Html.TextBoxFor(m => m.ConcerPerson1Designation, new { @class = "form-control form-control-lg", @Placeholder = "Concern Person 2 Designation" })
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-md-4">
                                                            <div class="form-group row">
                                                                <label class="control-label text-right col-md-3">Concern Person Contact </label>
                                                                <div class="col-md-9">
                                                                    @Html.TextBoxFor(m => m.ConcerPersonContact, new { @class = "form-control form-control-lg", @Placeholder = "Concern Person Contact", onkeypress = "return isNumber(event);", @maxlength = "10" })
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>

                                                    <div class="row">
                                                        <div class="col-md-4">
                                                            <div class="form-group row">
                                                                <label class="control-label text-right col-md-3">Concern Person Email </label>
                                                                <div class="col-md-9">
                                                                    @Html.TextBoxFor(m => m.ConcerPersonEmail, new { @class = "form-control form-control-lg", @Placeholder = "Concern Person Email" })
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-md-4">
                                                            <div class="form-group row">
                                                                <label class="control-label text-right col-md-3">Concern Person 2</label>
                                                                <div class="col-md-9">
                                                                    @Html.TextBoxFor(m => m.ConcernPerson2, new { @class = "form-control form-control-lg", @Placeholder = "Concern Person", @style = "text-transform:capitalize" })
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-md-4">
                                                            <div class="form-group row">
                                                                <label class="control-label text-right col-md-3">Concern Person 2 Designation</label>
                                                                <div class="col-md-9">
                                                                    @Html.TextBoxFor(m => m.ConcerPerson2Designation, new { @class = "form-control form-control-lg", @Placeholder = "Concern Person 2 Designation" })
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>

                                                    <div class="row">
                                                        <div class="col-md-4">
                                                            <div class="form-group row">
                                                                <label class="control-label text-right col-md-3">Concern Person Email </label>
                                                                <div class="col-md-9">
                                                                    @Html.TextBoxFor(m => m.ConcerPersonEmail2, new { @class = "form-control form-control-lg", @Placeholder = "Concern Person 2 Email" })
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-md-4">
                                                            <div class="form-group row">
                                                                <label class="control-label text-right col-md-3">Concern Person Contact </label>
                                                                <div class="col-md-9">
                                                                    @Html.TextBoxFor(m => m.ConcerPersonContact2, new { @class = "form-control form-control-lg", @Placeholder = "Concern Person 2 Contact", onkeypress = "return isNumber(event);", @maxlength = "10" })
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>

                                                    <div class="row">
                                                        <div class="col-md-4">
                                                            <div class="form-group row">
                                                                <label class="control-label text-right col-md-3">GSTNo</label>
                                                                <div class="col-md-9">
                                                                    @Html.TextBoxFor(m => m.GSTNO, new { @class = "form-control form-control-lg", @Placeholder = "GSTNO" })
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-md-4">
                                                            <div class="form-group row">
                                                                <label class="control-label text-right col-md-3">PAN Number </label>
                                                                <div class="col-md-9">
                                                                    @Html.TextBoxFor(m => m.PANNO, new { @class = "form-control form-control-lg", @Placeholder = "PAN Number", @style = "text-transform:uppercase", @maxlength = "10" })
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-md-4">
                                                            <div class="form-group row">
                                                                <label class="control-label text-right col-md-3">PAN Image </label>
                                                                <div class="col-md-9">
                                                                    <input type="file" name="postedFile" onchange="readURL1(this)" />
                                                                    <br />
                                                                    <img id="imgPAN" class="fileinput-preview thumbnail" style="width: 150px; height: 100px;" src="@Model.PanImage" />
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>

                                                    <div class="row">
                                                        <div class="col-md-4">
                                                            <div class="row">
                                                                <div class="col-md-offset-3 col-md-9">
                                                                    @if (Model.VendorId != null)
                                                                    {
                                                                        <input type="submit" value="Update Vendor" class="btn btn-success" name="UpdateVendor" onclick="return validateVendor();" />
                                                                    }
                                                                    else
                                                                    {
                                                                        <input type="submit" value="Save Vendor" class="btn btn-success" name="SaveVendor" onclick="return validateVendor();" />

                                                                        <a href="/Vendor/AddVendor" class="btn btn-dark">Reset</a>
                                                                    }
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-md-4"></div>
                                                    </div>
                                                </div>
                                            </div>
                                       
                                    </div>
                                </div>
                                @Html.HiddenFor(m => m.Result)
                            
                        }

                    </div>
                    </div>
                </div>
            </div>
        </div>

                    <script src="~/assets/libs/jquery/dist/jquery.min.js"></script>
                    <script>
                        $(document).ready(function () {
                            $("#divload").css({ 'display': '' });
                            var cityuse = [];
                            $.ajax({
                                url: '/Vendor/GetAllBanks',
                                type: 'Post',
                                success: function (response) {
                                    if (response != null) {
                                        $(response).each(function (index, item) { // GETTING ERROR HERE
                                            cityuse.push(item.BankName + "(" + item.IFSCCode + ")");
                                            $("#divload").css({ 'display': 'none' });
                                        });

                                        $('#BankName').autocomplete({
                                            source: cityuse,
                                            select: function (event, ui) {
                                                var str = ui.item.label;
                                                var afterComma = str.substr(str.indexOf("(") + 1);
                                                var citycode = afterComma.substr(0, afterComma.length - 1);
                                                var bankname = str.split('(');
                                                $('#IFSCCode').val(citycode);
                                                $('#BankNameSplit').val(bankname[0]);
                                                //alert(bankname[0]);
                                            }
                                        })
                                    }
                                    else {

                                    }
                                }, error: function () { alert('Some Thing wrong!'); }
                            });
                            $("#divload").css({ 'display': 'none' });
                        });

                        function readURL1(input) {
                            if (input.files && input.files[0]) {
                                var reader = new FileReader();
                                reader.onload = function (e) {
                                    $('#imgPAN')
                                        .attr('src', e.target.result);
                                };
                                reader.readAsDataURL(input.files[0]);
                            }
                        }

                        $(document).ready(function () {
                            //alert($('#Result').val());
                            document.getElementById("lblServiceDisplay").value = $('#Result').val();
                        });

                        function clearServices() {
                            document.getElementById("lblServiceDisplay").value = "";
                            $('#ServiceTypeID').val('');
                        }

                        function ServiceTypeChange() {
                            var serviceNameCurrent = $('#ServiceTypeName').find(":selected").text();
                            var serviceIDCurrent = $('#ServiceTypeName').val();

                            var serviceNameOld = document.getElementById("lblServiceDisplay").value;
                            var serviceIDOld = $('#ServiceTypeID').val();

                            var idArray = serviceIDOld.split(",");
                            for (var i = 0; i < idArray.length; i++) {
                                if (idArray[i] == serviceIDCurrent) {
                                    //alert(idArray[i]);
                                    return false;
                                }
                            }

                            if (serviceNameOld == "") {
                                $('#ServiceTypeID').val(serviceIDCurrent);
                                document.getElementById("lblServiceDisplay").value = serviceNameCurrent;
                            }
                            else {
                                $('#ServiceTypeID').val(serviceIDOld + "," + serviceIDCurrent);
                                document.getElementById("lblServiceDisplay").value = serviceNameOld + ", " + serviceNameCurrent;
                            }
                            //alert("IDs : " + $('#ServiceTypeID').val());
                        }

                        function isNumber(evt) {
                            var charCode = (evt.which) ? evt.which : evt.keyCode;
                            if (charCode != 46 && charCode > 31
                              && (charCode < 48 || charCode > 57))
                                return false;

                            return true;
                        }

                        function validateVendor() {
                            $(".errortext").removeClass("errortext");
                            if ($('#VendorName').val() == '') {
                                $("#VendorName").addClass('errortext');
                                $('#VendorName').focus();
                                return false;
                            }
                            if ($('#ServiceTypeName').val() == "0") {
                                $("#ServiceTypeName").addClass('errortext');
                                $('#ServiceTypeName').focus();
                                return false;
                            }
                            if ($('#MobileNo').val() == '') {
                                $("#MobileNo").addClass('errortext');
                                $('#MobileNo').focus();
                                return false;
                            }

                            if ($('#Email').val() == '') {
                                $("#Email").addClass('errortext');
                                $('#Email').focus();
                                return false;
                            }
                            if ($('#Address').val() == '') {
                                $("#Address").addClass('errortext');
                                $('#Address').focus();
                                return false;

                            }
                            if ($('#Pincode').val() == '') {
                                $("#Pincode").addClass('errortext');
                                $('#Pincode').focus();
                                return false;
                            }

                            $("#divload").css({ 'display': '' });



                        }

                        function getstatecity() {
                            $("#divload").css({ 'display': '' });
                            $.ajax({
                                url: "/Master/GetStateCity",
                                Type: "Get",
                                DataType: "JSON",
                                data: { PinCode: $("#Pincode").val() },
                                success: function (data) {
                                    if (data.Result == "1") {
                                        $("#StateName").val(data.StateName);
                                        $("#City").val(data.City);
                                        $("#divload").css({ 'display': 'none' });
                                    }
                                    else {
                                        $("#StateName").val('');
                                        $("#City").val('');
                                        $("#PinCode").val('');
                                        alert('Invalid PinCode');
                                        $('#PinCode').focus();
                                        $("#divload").css({ 'display': 'none' });

                                    }


                                }

                            });
                        }

                    </script>




